/*!
	Easybox v0.1 - Lightweight easy to use lightbox clone for jQuery
	Based on Slimbox2 by Christophe Beyls <http://www.digitalia.be>
*/
/android|iphone|ipod|series60|symbian|windows ce|blackberry|msie 6/i.test(navigator.userAgent)||jQuery(function(b){b("a[rel^='lightbox']").easybox({/* custom options here */},null,function(a){return this==a||this.rel.length>8&&this.rel==a.rel})});
(function(a){function L(b){b?a("object").add("embed").each(function(a,b){A[a]=[b,b.style.visibility];b.style.visibility="hidden"}):(a.each(A,function(a,b){b[0].style.visibility=b[1]}),A=[]);a(document)[b?"bind":"unbind"]("keydown",R)}function R(b){var b=b.keyCode,g=a.inArray;return g(b,c.closeKeys)>=0?M():g(b,c.nextKeys)>=0?B():g(b,c.previousKeys)>=0?C():!1}function C(){r=1;return u(m)}function B(){r=0;return u(k)}function u(b){if(b>=0){e=b;m=(e||(c.loop?d.length:0))-1;k=(e+1)%d.length||(c.loop?0:
-1);D();if(m>=0&&/(\.jpg|\.jpeg|\.png|\.gif)$/i.test(d[m][0]))(new Image).src=d[m][0];if(k>=0&&/(\.jpg|\.jpeg|\.png|\.gif)$/i.test(d[k][0]))(new Image).src=d[k][0];N()?(a(f).addClass("easyLoading"),h=new Image,h.onload=function(){E=this.width;F=this.height;n()},h.onerror=function(){o=!0;n()},h.src=d[e][0]):(id=O())!=!1?(a(f).addClass("easyLoading"),s=a.ajax("http://gdata.youtube.com/feeds/api/videos?v=2&alt=jsonc",{type:"GET",data:{q:id},dataType:"jsonp",timeout:2E3,success:function(a){a.data.totalItems&&
(a.data.items[0].accessControl.embed=="allowed"?G=a.data.items[0].aspectRatio=="widescreen":o=!0);n()},error:function(a,b){b!="abort"&&(o=!0,n())}})):(id=P())!=!1?(a(f).addClass("easyLoading"),s=a.ajax("http://vimeo.com/api/v2/video/"+id+".json",{type:"GET",dataType:"jsonp",timeout:2E3,success:function(a){a.length&&(a[0].embed_privacy=="anywhere"||a[0].embed_privacy=="approved"?(H=a[0].width||0,I=a[0].height||0):o=!0);n()},error:function(a,b){b!="abort"&&(o=!0,n())}})):n()}return!1}function n(){var b,
g;a(f).removeClass();o?(a(f).addClass("easyError"),j=c.initWidth,l=c.initHeight,a([J,K]).html("")):(N()?(b=t({w:E,h:F}),g=a('<img src="'+d[e][0]+'" width="'+b.w+'" height="'+b.h+'" alt="'+d[e][1]+'" />')):(id=O())!=!1?(b=t({w:Math.round(c.ytPlayerHeight*(G?16/9:4/3)),h:c.ytPlayerHeight}),g=a('<iframe src="http://www.youtube.com/embed/'+id+'?version=3&autohide=1&autoplay=1&rel=0" width="'+b.w+'" height="'+b.h+'" frameborder="0"></iframe>')):(id=P())!=!1?(b=t({w:H,h:I}),g=a('<iframe src="http://player.vimeo.com/video/'+
id+'?title=0&byline=0&portrait=0&autoplay=true" width="'+b.w+'" height="'+b.h+'" frameborder="0"></iframe>')):(id=S())!=!1?(i=a("#"+id)[0],a(i).parent(),b=t({w:a(i).width(),h:a(i).height()}),g=a(i).css({display:"block"})):(b=t({}),g=a('<iframe width="'+b.w+'" height="'+b.h+'" src="'+d[e][0]+'" frameborder="0"></iframe>')),a(p).css({visibility:"hidden",display:""}).width(b.w).height(b.h),j=p.offsetWidth,l=p.offsetHeight,a(J).html(d[e][1]||""),a(K).html((d.length>1&&c.counterText||"").replace(/{x}/,
e+1).replace(/{y}/,d.length)));(f.offsetHeight!=l||f.offsetWidth!=j)&&a(f).animate({height:l,marginTop:-l/2,width:j,marginLeft:-j/2},c.resizeDuration,c.resizeEasing);a(f).queue(function(){a(v).css({width:j,marginLeft:-j/2,marginTop:l/2});a(q).css({marginLeft:-j/2-Math.floor(a(q).width()*1.5)});a(w).css({marginLeft:j/2+Math.ceil(a(q).width()*0.5)});a(p).append(g).css({display:"none",visibility:"",opacity:""}).fadeIn(c.fadeDuration,T);c.slideshow&&k>=0&&(x=setInterval(r?C:B,c.slideshow))})}function T(){m>=
0&&a(q).css({display:"none",visibility:"",opacity:""}).fadeIn(c.captionFadeDuration);k>=0&&a(w).css({display:"none",visibility:"",opacity:""}).fadeIn(c.captionFadeDuration);a(v).css({opacity:""}).fadeIn(c.captionFadeDuration);a(y).css("marginTop",-y.offsetHeight).animate({marginTop:0},c.captionFadeDuration)}function D(){var b;a(f).removeClass();if(h!=null)b=h.onload=h.onerror=null,h=b;s!=null&&(s.abort(),s=null);x!=null&&(clearInterval(x),x=null);i!=null&&(a("body").append(a(i).css({display:""})),
i=null);G=o=!1;H=I=E=F=0;a(p).empty();a([f,y]).stop(!0);a([p,v,q,w]).stop(!0).css({display:"none"})}function M(){e>=0&&(D(),e=m=k=-1,r=0,a(z).stop().fadeOut(c.fadeDuration,L),a(f).animate({height:c.closeHeight,marginTop:-c.closeHeight/2,width:c.closeWidth,marginLeft:-c.closeWidth/2,opacity:0},c.fadeDuration,function(){a(f).hide()}));return!1}function N(){return/(\.jpg|\.jpeg|\.png|\.gif)$/i.test(d[e][0])}function O(){var a=/^http\:\/\/www\.youtube\.com\/watch\?v=([A-Za-z0-9]*)(&(.*))?$/i.exec(d[e][0]);
return a!=null?a[1]:!1}function P(){var a=/^http\:\/\/vimeo\.com\/([0-9]*)(.*)?$/i.exec(d[e][0]);return a!=null?a[1]:!1}function S(){var b=/^(.*)\#([A-Za-z0-9\-_]*)$/i.exec(d[e][0]);return b!=null&&a("#"+b[2]).length?b[2]:!1}function t(a){if(!(a.w>0&&a.h>0))a.w=c.defWidth,a.h=c.defHeight;if(a.h>c.maxHeight)a.w=Math.round(c.maxHeight*a.w/a.h),a.h=c.maxHeight;if(a.w>c.maxWidth)a.h=Math.round(c.maxWidth/a.w*a.h),a.w=c.maxWidth;return a}var c,d,e=-1,m,k,j,l,A=[],r=0,h=null,s=null,i=null,x=null,E=0,F=
0,H=0,I=0,G=0,o=!1,z,f,p,q,w,v,y,J,K;a(function(){a("body").append(a([z=a('<div id="easyOverlay" />')[0],f=a('<div id="easyCenter" />').append([p=a('<div id="easyContainer" />')[0]])[0],q=a('<a id="easyPrevLink" href="#" />').click(C)[0],w=a('<a id="easyNextLink" href="#" />').click(B)[0],v=a('<div id="easyBottomContainer" />').append([y=a('<div id="easyBottom" />').append([a('<a id="easyCloseLink" href="#" />').add(z).click(M)[0],J=a('<div id="easyCaption" />')[0],K=a('<div id="easyNumber" />')[0],
a('<div style="clear: both;" />')[0]])[0]])[0]]).css("display","none"))});a.easybox=function(b,g,h,i){var Q=!1;e>=0&&(D(),e=m=k=-1,r=0,Q=!0);c=a.extend({loop:!1,dynOpts:!0,overlayOpacity:0.8,resizeDuration:400,resizeEasing:"easybox",fadeDuration:400,initWidth:250,initHeight:250,defWidth:960,defHeight:720,closeWidth:128,closeHeight:128,maxWidth:1280,maxHeight:720,maxScreenFill:0.7,ytPlayerHeight:480,captionFadeDuration:200,slideshow:0,counterText:"{x} of {y}",closeKeys:[27,88,67],previousKeys:[37,
80],nextKeys:[39,78]},h);c.dynOpts&&a("#easyOptions").each(function(){var b=this;(!a(b).attr("data-rel")||typeof i=="string"&&a(b).attr("data-rel")==i)&&a.each(c,function(g){a(b).attr("data-"+g)&&(c[g]=a(b).attr("data-"+g))})});typeof b=="string"&&(b=[[b,g]],g=0);if(c.maxScreenFill)c.maxWidth=Math.min(Math.round(screen.width*c.maxScreenFill),c.maxWidth),c.maxHeight=Math.min(Math.round(screen.height*c.maxScreenFill),c.maxHeight);d=b;c.loop=c.loop&&d.length>1;Q?u(g):(j=c.initWidth,l=c.initHeight,a(f).css({width:j,
height:l,marginLeft:-j/2,marginTop:-l/2,opacity:""}),L(1),a(f).show(),a(z).css("opacity",c.overlayOpacity).fadeIn(c.fadeDuration,function(){u(g)}));return!1};a.fn.easybox=function(b,c,d){var c=c||function(a){return[a.href,a.title]},d=d||function(a){return this==a},e=this;return e.unbind("click").click(function(){var f=this,j=0,i,h=0,k;i=a.grep(e,function(a,b){return d.call(f,a,b)});for(k=i.length;h<k;++h)i[h]==f&&(j=h),i[h]=c(i[h],h);return a.easybox(i,j,b,a(f).attr("rel")||null)})};a.easing.easybox=
function(a){return a<0.7?Math.pow(a/0.7,2)*1.2:1.2-Math.sqrt((a-0.7)/(1-0.7))*0.2}})(jQuery);
