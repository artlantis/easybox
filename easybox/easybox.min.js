/*!
	Easybox v0.1 - Lightweight easy to use lightbox clone for jQuery
	Based on Slimbox2 by Christophe Beyls <http://www.digitalia.be>
*/
/android|iphone|ipod|series60|symbian|windows ce|blackberry|msie 6/i.test(navigator.userAgent)||jQuery(function(b){b("a[rel^='lightbox']").easybox({/* custom options here */},null,function(a){return this==a||this.rel.length>8&&this.rel==a.rel})});
(function(a){function D(b){b?a("object").add("embed").each(function(a,b){z[a]=[b,b.style.visibility];b.style.visibility="hidden"}):(a.each(z,function(a,b){b[0].style.visibility=b[1]}),z=[]);a(document)[b?"bind":"unbind"]("keydown",M)}function M(b){var b=b.keyCode,d=a.inArray;return d(b,c.closeKeys)>=0?E():d(b,c.nextKeys)>=0?F():d(b,c.previousKeys)>=0?G():!1}function G(){return A(l)}function F(){return A(m)}function A(b){if(b>=0){h=b;l=(h||(c.loop?e.length:0))-1;m=(h+1)%e.length||(c.loop?0:-1);H();
if(l>=0&&/(\.jpg|\.jpeg|\.png|\.gif)$/i.test(e[l][0]))(new Image).src=e[l][0];if(m>=0&&/(\.jpg|\.jpeg|\.png|\.gif)$/i.test(e[m][0]))(new Image).src=e[m][0];I()?(a(f).addClass("easyLoading"),k=new Image,k.onload=function(){s=this.width;t=this.height;n()},k.onerror=function(){o=!0;n()},k.src=e[h][0]):(id=J())!=!1?(a(f).addClass("easyLoading"),q=a.ajax("http://gdata.youtube.com/feeds/api/videos?v=2&alt=jsonc",{type:"GET",data:{q:id},dataType:"jsonp",timeout:2E3,success:function(a){a.data.totalItems&&
(a.data.items[0].accessControl.embed=="allowed"?B=a.data.items[0].aspectRatio=="widescreen":o=!0);n()},error:function(a,b){b!="abort"&&(o=!0,n())}})):(id=K())!=!1?(a(f).addClass("easyLoading"),q=a.ajax("http://vimeo.com/api/v2/video/"+id+".json",{type:"GET",dataType:"jsonp",timeout:2E3,success:function(a){a.length&&(a[0].embed_privacy=="anywhere"||a[0].embed_privacy=="approved"?(u=a[0].width||0,v=a[0].height||0):o=!0);n()},error:function(a,b){b!="abort"&&(o=!0,n())}})):n()}return!1}function n(){var b=
0,d=0;a(f).removeClass();if(o)a(f).addClass("easyError"),g=c.initWidth,i=c.initHeight,a(C).html("");else{if(I()){b=s>0?s:c.defWidth;d=t>0?t:c.defHeight;if(d>c.maxHeight)b=Math.round(c.maxHeight*b/d),d=c.maxHeight;if(b>c.maxWidth)d=Math.round(c.maxWidth/b*d),b=c.maxWidth;a('<img src="'+e[h][0]+'" width="'+b+'" height="'+d+'" alt="'+e[h][1]+'" />').appendTo(j)}else if((id=J())!=!1)d=c.ytPlayerHeight,b=Math.round(d*(B?16/9:4/3)),a('<iframe src="http://www.youtube.com/embed/'+id+'?version=3&autohide=1&autoplay=1&rel=0" width="'+
b+'" height="'+d+'" frameborder="0"></iframe>').appendTo(j);else if((id=K())!=!1){b=u>0?u:c.defWidth;d=v>0?v:c.defHeight;if(d>c.maxHeight)b=Math.round(c.maxHeight*b/d),d=c.maxHeight;if(b>c.maxWidth)d=Math.round(c.maxWidth/b*d),b=c.maxWidth;a('<iframe src="http://player.vimeo.com/video/'+id+'?title=0&byline=0&portrait=0&autoplay=true" width="'+b+'" height="'+d+'" frameborder="0"></iframe>').appendTo(j)}else b=c.defWidth,d=c.defHeight,a('<iframe width="'+b+'" height="'+d+'" src="'+e[h][0]+'"></iframe>').appendTo(j);
a(j).css({visibility:"hidden",display:""}).width(b).height(d);g=j.offsetWidth;i=j.offsetHeight;a(C).html(e[h][1]||"")}a(L).html((e.length>1&&c.counterText||"").replace(/{x}/,h+1).replace(/{y}/,e.length));(f.offsetHeight!=i||f.offsetWidth!=g)&&a(f).animate({height:i,marginTop:-i/2,width:g,marginLeft:-g/2},c.resizeDuration,c.resizeEasing);a(f).queue(function(){a(w).css({width:g,marginLeft:-g/2,marginTop:i/2});a(p).css({marginLeft:-g/2-Math.floor(a(p).width()*1.5)});a(r).css({marginLeft:g/2+Math.ceil(a(p).width()*
0.5)});a(j).css({display:"none",visibility:"",opacity:""}).fadeIn(c.fadeDuration,N)})}function N(){l>=0&&a(p).css({display:"none",visibility:"",opacity:""}).fadeIn(c.captionFadeDuration);m>=0&&a(r).css({display:"none",visibility:"",opacity:""}).fadeIn(c.captionFadeDuration);a(w).css({visibility:"",display:""});a(x).css("marginTop",-x.offsetHeight).animate({marginTop:0},c.captionFadeDuration)}function H(){var b;a(f).removeClass();if(k!=null)b=k.onload=k.onerror=null,k=b;q!=null&&(q.abort(),q=null);
B=o=!1;u=v=s=t=0;a(j).empty();a([f,j,x,p,r]).stop(!0);a([j,w,p,r]).css({display:"none",visibility:"hidden"})}function E(){h>=0&&(H(),h=l=m=-1,a(y).stop().fadeOut(c.fadeDuration,D),a(f).animate({height:c.closeHeight,marginTop:-c.closeHeight/2,width:c.closeWidth,marginLeft:-c.closeWidth/2,opacity:0},c.fadeDuration,function(){a(f).hide()}));return!1}function I(){return/(\.jpg|\.jpeg|\.png|\.gif)$/i.test(e[h][0])}function J(){var a=/^http\:\/\/www\.youtube\.com\/watch\?v=([A-Za-z0-9]*)(&(.*))?/i.exec(e[h][0]);
return a!=null?a[1]:!1}function K(){var a=a=/^http\:\/\/vimeo\.com\/([0-9]*)(.*)?/i.exec(e[h][0]);return a!=null?a[1]:!1}var c,e,h=-1,l,m,g,i,z=[],k=null,q=null,s=0,t=0,u=0,v=0,B=0,o=!1,y,f,j,p,r,w,x,C,L;a(function(){a("body").append(a([y=a('<div id="easyOverlay" />')[0],f=a('<div id="easyCenter" />').append([j=a('<div id="easyContainer" />')[0]])[0],p=a('<a id="easyPrevLink" href="#" />').click(G)[0],r=a('<a id="easyNextLink" href="#" />').click(F)[0],w=a('<div id="easyBottomContainer" />').append([x=
a('<div id="easyBottom" />').append([a('<a id="easyCloseLink" href="#" />').add(y).click(E)[0],C=a('<div id="easyCaption" />')[0],L=a('<div id="easyNumber" />')[0],a('<div style="clear: both;" />')[0]])[0]])[0]]).css("display","none"))});a.easybox=function(b,d,j){if(h>=0)return!1;c=a.extend({loop:!1,overlayOpacity:0.8,resizeDuration:400,resizeEasing:"easybox",fadeDuration:400,initWidth:250,initHeight:250,defWidth:640,defHeight:480,closeWidth:128,closeHeight:128,maxWidth:1280,maxHeight:720,ytPlayerHeight:360,
captionFadeDuration:200,counterText:"{x} of {y}",closeKeys:[27,88,67],previousKeys:[37,80],nextKeys:[39,78]},j);typeof b=="string"&&(b=[[b,d]],d=0);e=b;c.loop=c.loop&&e.length>1;g=c.initWidth;i=c.initHeight;a(f).css({width:g,height:i,marginLeft:-g/2,marginTop:-i/2,opacity:""});D(1);a(f).show();a(y).css("opacity",c.overlayOpacity).fadeIn(c.fadeDuration,function(){A(d)});return!1};a.fn.easybox=function(b,c,e){var c=c||function(a){return[a.href,a.title]},e=e||function(){return!0},f=this;return f.unbind("click").click(function(){var h=
this,j=0,g,i=0,k;g=a.grep(f,function(a,b){return e.call(h,a,b)});for(k=g.length;i<k;++i)g[i]==h&&(j=i),g[i]=c(g[i],i);return a.easybox(g,j,b)})};a.easing.easybox=function(a){return a<0.7?Math.pow(a/0.7,2)*1.2:1.2-Math.sqrt((a-0.7)/(1-0.7))*0.2}})(jQuery);
